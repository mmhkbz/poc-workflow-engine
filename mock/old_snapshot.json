{
  "roles": [
    {
      "id": "manager",
      "key": "manager",
      "name": "Manager"
    },
    {
      "id": "senior_manager",
      "key": "senior_manager",
      "name": "Senior Manager"
    },
    {
      "id": "ceo",
      "key": "ceo",
      "name": "CEO"
    }
  ],
  "users": [
    {
      "key": "user1",
      "name": "User 1",
      "roles": ["manager"]
    },
    {
      "key": "user2",
      "name": "User 2",
      "roles": ["senior_manager"]
    }
  ],
  "workflows": [
    {
      "key": "csv_upload_v1",
      "name": "CSV Upload Workflow (Manager)",
      "nodes": [
        {
          "key": "start",
          "type": "start"
        },
        {
          "key": "first_approval",
          "type": "task",
          "config": {
            "type": "assignment",
            "payload": {
              "type": "role",
              "roles": ["manager"]
            }
          }
        },
        {
          "key": "first_decision",
          "type": "decision"
        },
        {
          "key": "second_approval",
          "type": "task",
          "config": {
            "type": "assignment",
            "payload": {
              "type": "role",
              "roles": ["senior_manager"]
            }
          }
        },
        {
          "key": "rejected_noti",
          "type": "service",
          "config": {
            "type": "service",
            "payload": {
              "type": "http",
              "method": "POST",
              "url": "https://41l5r34h-3001.asse.devtunnels.ms/api/notifications",
              "body": {
                "title": "Rejected request.",
                "message": "Your request was rejected."
              }
            }
          }
        },
        {
          "key": "second_decision",
          "type": "decision"
        },
        {
          "key": "approved_noti",
          "type": "service",
          "config": {
            "type": "service",
            "payload": {
              "type": "http",
              "method": "POST",
              "url": "https://41l5r34h-3001.asse.devtunnels.ms/api/notifications",
              "body": {
                "title": "Approved",
                "message": "Your request was approved by manager."
              }
            }
          }
        },
        {
          "key": "process_csv",
          "type": "service",
          "config": {
            "type": "service",
            "payload": {
              "type": "http",
              "method": "POST",
              "url": "https://41l5r34h-3001.asse.devtunnels.ms/api/process-csv",
              "body": {
                "refId": "variables.refId"
              }
            }
          }
        },
        {
          "key": "end",
          "type": "end"
        }
      ],
      "transitions": [
        {
          "fromNode": "start",
          "toNode": "first_approval"
        },
        {
          "fromNode": "first_approval",
          "toNode": "first_decision"
        },
        {
          "fromNode": "first_decision",
          "toNode": "rejected_noti",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.first_approval.isApproved == false"
            }
          }
        },
        {
          "fromNode": "first_decision",
          "toNode": "approved_noti",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.first_approval.isApproved == true"
            }
          }
        },
        {
          "fromNode": "rejected_noti",
          "toNode": "end"
        },
        {
          "fromNode": "approved_noti",
          "toNode": "process_csv"
        },
        {
          "fromNode": "process_csv",
          "toNode": "end"
        }
      ]
    },
    {
      "key": "csv_upload_v2",
      "name": "CSV Upload Workflow (Manager + Senior Manager)",
      "nodes": [
        {
          "key": "start",
          "type": "start"
        },
        {
          "key": "first_approval",
          "type": "task",
          "config": {
            "type": "assignment",
            "payload": {
              "type": "role",
              "roles": ["manager"]
            }
          }
        },
        {
          "key": "first_decision",
          "type": "decision"
        },
        {
          "key": "second_approval",
          "type": "task",
          "config": {
            "type": "assignment",
            "payload": {
              "type": "role",
              "roles": ["senior_manager"]
            }
          }
        },
        {
          "key": "rejected_noti",
          "type": "service",
          "config": {
            "type": "service",
            "payload": {
              "type": "http",
              "method": "POST",
              "url": "https://41l5r34h-3001.asse.devtunnels.ms/api/notifications",
              "body": {
                "title": "Rejected request.",
                "message": "Your request was rejected."
              }
            }
          }
        },
        {
          "key": "second_decision",
          "type": "decision"
        },
        {
          "key": "approved_noti",
          "type": "service",
          "config": {
            "type": "service",
            "payload": {
              "type": "http",
              "method": "POST",
              "url": "https://41l5r34h-3001.asse.devtunnels.ms/api/notifications",
              "body": {
                "title": "Approved",
                "message": "Your request was approved."
              }
            }
          }
        },
        {
          "key": "process_csv",
          "type": "service",
          "config": {
            "type": "service",
            "payload": {
              "type": "http",
              "method": "POST",
              "url": "https://41l5r34h-3001.asse.devtunnels.ms/api/process-csv",
              "body": {
                "refId": "variables.refId"
              }
            }
          }
        },
        {
          "key": "end",
          "type": "end"
        }
      ],
      "transitions": [
        {
          "fromNode": "start",
          "toNode": "first_approval"
        },
        {
          "fromNode": "first_approval",
          "toNode": "first_decision"
        },
        {
          "fromNode": "first_decision",
          "toNode": "rejected_noti",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.first_approval.isApproved == false"
            }
          }
        },
        {
          "fromNode": "first_decision",
          "toNode": "second_approval",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.first_approval.isApproved == true"
            }
          }
        },
        {
          "fromNode": "second_approval",
          "toNode": "second_decision"
        },
        {
          "fromNode": "second_decision",
          "toNode": "rejected_noti",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.second_approval.isApproved == false"
            }
          }
        },
        {
          "fromNode": "second_decision",
          "toNode": "approved_noti",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.second_approval.isApproved == true"
            }
          }
        },
        {
          "fromNode": "rejected_noti",
          "toNode": "end"
        },
        {
          "fromNode": "approved_noti",
          "toNode": "process_csv"
        },
        {
          "fromNode": "process_csv",
          "toNode": "end"
        }
      ]
    },
    {
      "key": "csv_upload_v3",
      "name": "CSV Upload Workflow (manager + senior manager + CEO)",
      "nodes": [
        {
          "key": "start",
          "type": "start"
        },
        {
          "key": "first_approval",
          "type": "task",
          "config": {
            "type": "assignment",
            "payload": {
              "type": "role",
              "roles": ["manager"]
            }
          }
        },
        {
          "key": "first_decision",
          "type": "decision"
        },
        {
          "key": "second_approval",
          "type": "task",
          "config": {
            "type": "assignment",
            "payload": {
              "type": "role",
              "roles": ["senior_manager"]
            }
          }
        },
        {
          "key": "rejected_noti",
          "type": "service",
          "config": {
            "type": "service",
            "payload": {
              "type": "http",
              "method": "POST",
              "url": "https://41l5r34h-3001.asse.devtunnels.ms/api/notifications",
              "body": {
                "title": "Rejected request.",
                "message": "Your request was rejected."
              }
            }
          }
        },
        {
          "key": "second_decision",
          "type": "decision"
        },
        {
          "key": "third_approval",
          "type": "task",
          "config": {
            "type": "assignment",
            "payload": {
              "type": "role",
              "roles": ["ceo"]
            }
          }
        },
        {
          "key": "third_decision",
          "type": "decision"
        },
        {
          "key": "approved_noti",
          "type": "service",
          "config": {
            "type": "service",
            "payload": {
              "type": "http",
              "method": "POST",
              "url": "https://41l5r34h-3001.asse.devtunnels.ms/api/notifications",
              "body": {
                "title": "Approved",
                "message": "Your request was approved."
              }
            }
          }
        },
        {
          "key": "end",
          "type": "end"
        },
        {
          "key": "process_csv",
          "type": "service",
          "config": {
            "type": "service",
            "payload": {
              "type": "http",
              "method": "POST",
              "url": "https://41l5r34h-3001.asse.devtunnels.ms/api/process-csv",
              "body": {
                "refId": "variables.refId"
              }
            }
          }
        }
      ],
      "transitions": [
        {
          "fromNode": "start",
          "toNode": "first_approval"
        },
        {
          "fromNode": "first_approval",
          "toNode": "first_decision"
        },
        {
          "fromNode": "first_decision",
          "toNode": "rejected_noti",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.first_approval.isApproved == false"
            }
          }
        },
        {
          "fromNode": "first_decision",
          "toNode": "second_approval",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.first_approval.isApproved == true"
            }
          }
        },
        {
          "fromNode": "second_approval",
          "toNode": "second_decision"
        },
        {
          "fromNode": "second_decision",
          "toNode": "third_approval",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.second_approval.isApproved == true"
            }
          }
        },
        {
          "fromNode": "second_decision",
          "toNode": "failed_noti",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.second_approval.isApproved == false"
            }
          }
        },
        {
          "fromNode": "third_approval",
          "toNode": "third_decision"
        },
        {
          "fromNode": "third_decision",
          "toNode": "failed_noti",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.third_approval.isApproved == false"
            }
          }
        },
        {
          "fromNode": "third_decision",
          "toNode": "approved_noti",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.third_approval.isApproved == true"
            }
          }
        },
        {
          "fromNode": "rejected_noti",
          "toNode": "end"
        },
        {
          "fromNode": "approved_noti",
          "toNode": "process_csv"
        },
        {
          "fromNode": "process_csv",
          "toNode": "end"
        }
      ]
    },
    {
      "key": "csv_upload_v4",
      "name": "CSV Upload Workflow (Manager + Senior) with Noti per step ",
      "nodes": [
        {
          "key": "start",
          "type": "start"
        },
        {
          "key": "first_approval",
          "type": "task",
          "config": {
            "type": "assignment",
            "payload": {
              "type": "role",
              "roles": ["manager"]
            }
          }
        },
        {
          "key": "first_decision",
          "type": "decision"
        },
        {
          "key": "second_approval",
          "type": "task",
          "config": {
            "type": "assignment",
            "payload": {
              "type": "role",
              "roles": ["senior_manager"]
            }
          }
        },
        {
          "key": "first_approved_noti",
          "type": "service",
          "config": {
            "type": "service",
            "payload": {
              "type": "http",
              "method": "POST",
              "url": "https://41l5r34h-3001.asse.devtunnels.ms/api/notifications",
              "body": {
                "title": "Approved",
                "message": "Your request was approved by manager."
              }
            }
          }
        },
        {
          "key": "rejected_noti",
          "type": "service",
          "config": {
            "type": "service",
            "payload": {
              "type": "http",
              "method": "POST",
              "url": "https://41l5r34h-3001.asse.devtunnels.ms/api/notifications",
              "body": {
                "title": "Rejected request.",
                "message": "Your request was rejected."
              }
            }
          }
        },
        {
          "key": "second_decision",
          "type": "decision"
        },
        {
          "key": "second_approved_noti",
          "type": "service",
          "config": {
            "type": "service",
            "payload": {
              "type": "http",
              "method": "POST",
              "url": "https://41l5r34h-3001.asse.devtunnels.ms/api/notifications",
              "body": {
                "title": "Approved",
                "message": "Your request was approved by senior manager."
              }
            }
          }
        },
        {
          "key": "process_csv",
          "type": "service",
          "config": {
            "type": "service",
            "payload": {
              "type": "http",
              "method": "POST",
              "url": "https://41l5r34h-3001.asse.devtunnels.ms/api/process-csv",
              "body": {
                "refId": "variables.refId"
              },
              "headers": {
                "Content-Type": "application/json"
              }
            }
          }
        },
        {
          "key": "end",
          "type": "end"
        }
      ],
      "transitions": [
        {
          "fromNode": "start",
          "toNode": "first_approval"
        },
        {
          "fromNode": "first_approval",
          "toNode": "first_decision"
        },
        {
          "fromNode": "first_decision",
          "toNode": "rejected_noti",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.first_approval.isApproved == false"
            }
          }
        },
        {
          "fromNode": "first_decision",
          "toNode": "first_approved_noti",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.first_approval.isApproved == true"
            }
          }
        },
        {
          "fromNode": "first_approved_noti",
          "toNode": "second_approval"
        },
        {
          "fromNode": "second_approval",
          "toNode": "second_decision"
        },
        {
          "fromNode": "second_decision",
          "toNode": "rejected_noti",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.second_approval.isApproved == false"
            }
          }
        },
        {
          "fromNode": "second_decision",
          "toNode": "second_approved_noti",
          "config": {
            "type": "condition",
            "payload": {
              "type": "jexl",
              "expression": "variables.outputs.second_approval.isApproved == true"
            }
          }
        },
        {
          "fromNode": "rejected_noti",
          "toNode": "end"
        },
        {
          "fromNode": "second_approved_noti",
          "toNode": "process_csv"
        },
        {
          "fromNode": "process_csv",
          "to": "end"
        }
      ]
    }
  ]
}
